{
  "entityType" : "CONVERTER",
  "entity" : {
    "additionalInfo" : {
      "description" : ""
    },
    "configuration" : {
      "scriptLang" : "TBEL",
      "decoder" : null,
      "tbelDecoder" : "// Decode an uplink message from a buffer\n// payload - array of bytes\n// metadata - key/value object\n\n/** Decoder **/\n\n// decode payload to string\nvar payloadStr = decodeToString(payload);\n\n// decode payload to JSON\n var data = decodeToJson(payload);\n\n//var deviceName = 'AGC4';\n\nvar result = [{\n   deviceName: 'AGC_1',\n   telemetry: {\n       //rawData: payloadStr,\n       AGC_VOLT_L1_L2:data[0].data.Generator_voltage_L1_L2,\n       AGC_VOLT_L2_L3:data[0].data.Generator_voltage_L2_L3,\n       AGC_VOLT_L3_L1:data[0].data.Generator_voltage_L3_L1,\n       AGC_HZ_L1:data[0].data.Generator_frequency_L1/100,\n       AGC_HZ_L2:data[0].data.Generator_frequency_L2/100,\n       AGC_HZ_L3:data[0].data.Generator_frequency_L3/100,\n       AGC_AMP_L1:data[0].data.Generator_current_L1/10,\n       AGC_AMP_L2:data[0].data.Generator_current_L2/10,\n       AGC_AMP_L3:data[0].data.Generator_current_L3/10,\n       AGC_POWER_L1:data[0].data.Generator_power_L1,\n       AGC_POWER_L2:data[0].data.Generator_power_L2,\n       AGC_POWER_L3:data[0].data.Generator_power_L3,\n       AGC_POWER:data[0].data.Generator_power,\n       AGC_REACTIVE_POWER_L1:data[0].data.Generator_reactive_power_L1,\n       AGC_REACTIVE_POWER_L2:data[0].data.Mains_reactive_power_L2,\n       AGC_REACTIVE_POWER_L3:data[0].data.Generator_reactive_power_L3,\n       AGC_REACTIVE_POWER:data[0].data.Generator_reactive_power,\n       AGC_EXPORT_DAY:data[0].data.Generator_Export_Day,\n       AGC_EXPORT_TOTAL:data[0].data.Generator_Export_Total,\n       AGC_ENGINE_SPEED:data[0].data.Engine_Speed,\n       AGC_FULE_RATE:data[0].data.Fuel_rate,\n       AGC_Run_Time:data[0].data.Running_hrs\n\n    \n   }\n},{\n   deviceName: 'AGC_2',\n   telemetry: {\n       //rawData: payloadStr,\n       AGC_VOLT_L1_L2:data[1].data.Generator_voltage_L1_L2,\n       AGC_VOLT_L2_L3:data[1].data.Generator_voltage_L2_L3,\n       AGC_VOLT_L3_L1:data[1].data.Generator_voltage_L3_L1,\n       AGC_HZ_L1:data[1].data.Generator_frequency_L1/100,\n       AGC_HZ_L2:data[1].data.Generator_frequency_L2/100,\n       AGC_HZ_L3:data[1].data.Generator_frequency_L3/100,\n       AGC_AMP_L1:data[1].data.Generator_current_L1/10,\n       AGC_AMP_L2:data[1].data.Generator_current_L2/10,\n       AGC_AMP_L3:data[1].data.Generator_current_L3/10,\n       AGC_POWER_L1:data[1].data.Generator_power_L1,\n       AGC_POWER_L2:data[1].data.Generator_power_L2,\n       AGC_POWER_L3:data[1].data.Generator_power_L3,\n       AGC_POWER:data[1].data.Generator_power,\n       AGC_REACTIVE_POWER_L1:data[1].data.Generator_reactive_power_L1,\n       AGC_REACTIVE_POWER_L2:data[1].data.Mains_reactive_power_L2,\n       AGC_REACTIVE_POWER_L3:data[1].data.Generator_reactive_power_L3,\n       AGC_REACTIVE_POWER:data[1].data.Generator_reactive_power,\n       AGC_EXPORT_DAY:data[1].data.Generator_Export_Day,\n       AGC_EXPORT_TOTAL:data[1].data.Generator_Export_Total,\n       AGC_ENGINE_SPEED:data[1].data.Engine_Speed,\n       AGC_FULE_RATE:data[1].data.Fuel_rate,\n       AGC_Run_Time:data[1].data.Running_hrs\n\n    \n   }\n},{\n   deviceName: 'AGC_3',\n   telemetry: {\n       //rawData: payloadStr,\n       AGC_VOLT_L1_L2:data[2].data.Generator_voltage_L1_L2,\n       AGC_VOLT_L2_L3:data[2].data.Generator_voltage_L2_L3,\n       AGC_VOLT_L3_L1:data[2].data.Generator_voltage_L3_L1,\n       AGC_HZ_L1:data[2].data.Generator_frequency_L1/100,\n       AGC_HZ_L2:data[2].data.Generator_frequency_L2/100,\n       AGC_HZ_L3:data[2].data.Generator_frequency_L3/100,\n       AGC_AMP_L1:data[2].data.Generator_current_L1/10,\n       AGC_AMP_L2:data[2].data.Generator_current_L2/10,\n       AGC_AMP_L3:data[2].data.Generator_current_L3/10,\n       AGC_POWER_L1:data[2].data.Generator_power_L1,\n       AGC_POWER_L2:data[2].data.Generator_power_L2,\n       AGC_POWER_L3:data[2].data.Generator_power_L3,\n       AGC_POWER:data[2].data.Generator_power,\n       AGC_REACTIVE_POWER_L1:data[2].data.Generator_reactive_power_L1,\n       AGC_REACTIVE_POWER_L2:data[2].data.Mains_reactive_power_L2,\n       AGC_REACTIVE_POWER_L3:data[2].data.Generator_reactive_power_L3,\n       AGC_REACTIVE_POWER:data[2].data.Generator_reactive_power,\n       AGC_EXPORT_DAY:data[2].data.Generator_Export_Day,\n       AGC_EXPORT_TOTAL:data[2].data.Generator_Export_Total,\n       AGC_ENGINE_SPEED:data[2].data.Engine_Speed,\n       AGC_FULE_RATE:data[2].data.Fuel_rate,\n       AGC_Run_Time:data[2].data.Running_hrs\n\n    \n   }\n},{\n   deviceName: 'BP720-Grid Meter-1',\n   telemetry: {\n       //rawData: payloadStr,\n       Bus_B_voltage_L1_L2:data[3].data.Generator_voltage_L1_L2,\n       Bus_B_voltage_L2_L3:data[3].data.Generator_voltage_L2_L3,\n       Bus_B_voltage_L3_L1:data[3].data.Generator_voltage_L3_L1,\n       Bus_B_frequency_L1:data[3].data.Generator_frequency_L1/100,\n       Bus_B_frequency_L2:data[3].data.Generator_frequency_L2/100,\n       Bus_B_frequency_L3:data[3].data.Generator_frequency_L3/100,\n       Bus_B_Ampere_L1:data[3].data.Generator_current_L1/10,\n       Bus_B_Ampere_L2:data[3].data.Generator_current_L2/10,\n       Bus_B_Ampere_L3:data[3].data.Generator_current_L3/10,\n       AGC_POWER_L1:data[3].data.Generator_power_L1,\n       AGC_POWER_L2:data[3].data.Generator_power_L2,\n       AGC_POWER_L3:data[3].data.Generator_power_L3,\n       Grid_Power_kW:data[3].data.Generator_power,\n       AGC_REACTIVE_POWER_L1:data[3].data.Generator_reactive_power_L1,\n       AGC_REACTIVE_POWER_L2:data[3].data.Mains_reactive_power_L2,\n       AGC_REACTIVE_POWER_L3:data[3].data.Generator_reactive_power_L3,\n       Grid_Power_kVAR:data[3].data.Generator_reactive_power,\n       Grid_Daily_Energy_Export_kWh:data[3].data.Generator_Export_Day,\n       Grid_Total_Energy_Export_kWh:data[3].data.Generator_Export_Total,\n       AGC_ENGINE_SPEED:data[3].data.Engine_Speed,\n       AGC_FULE_RATE:data[3].data.Fuel_rate,\n       Grid_Daily_Energy_Import_kWh:data[4].data.Import_day,\n       AGC_4_Grid_Status:(data[3].data.Generator_voltage_L1_L2 > 380) && (data[3].data.Generator_voltage_L2_L3 > 380) && (data[3].data.Generator_voltage_L3_L1 > 380) && ((data[3].data.Generator_frequency_L1/100) > 40 ),\n       Grid_AVG_Frequency : (data[3].data.Generator_frequency_L1/100+data[3].data.Generator_frequency_L2/100+data[3].data.Generator_frequency_L3/100)/3\n     \n\n    \n   }\n},{\n   deviceName: 'BP720-DG-1',\n   telemetry: {\n       //rawData: payloadStr,\n       B1_DG_DG_1_VOLT_L1_L2:data[0].data.Generator_voltage_L1_L2,\n       B1_DG_DG_1_VOLT_L2_L3:data[0].data.Generator_voltage_L2_L3,\n       B1_DG_DG_1_VOLT_L3_L1:data[0].data.Generator_voltage_L3_L1,\n       B1_DG_DG_1_Frequency_Hz_L1:data[0].data.Generator_frequency_L1/100,\n       B1_DG_DG_1_Frequency_Hz_L2:data[0].data.Generator_frequency_L2/100,\n       B1_DG_DG_1_Frequency_Hz_L3:data[0].data.Generator_frequency_L3/100,\n       B1_DG_DG_1_AMP_L1:data[0].data.Generator_current_L1/10,\n       B1_DG_DG_1_AMP_L2:data[0].data.Generator_current_L2/10,\n       B1_DG_DG_1_AMP_L3:data[0].data.Generator_current_L3/10,\n       B1_DG_DG_1_AC_Active_Power_Watt_L1:data[0].data.Generator_power_L1,\n       B1_DG_DG_1_AC_Active_Power_Watt_L2:data[0].data.Generator_power_L2,\n       B1_DG_DG_1_AC_Active_Power_Watt_L3:data[0].data.Generator_power_L3,\n       B1_DG_DG_1_AC_Active_Power_Watt:data[0].data.Generator_power,\n       B1_DG_DG_1_AC_Reactive_Power_var_L1:data[0].data.Generator_reactive_power_L1,\n       B1_DG_DG_1_AC_Reactive_Power_var_L2:data[0].data.Mains_reactive_power_L2,\n       B1_DG_DG_1_AC_Reactive_Power_var_L3:data[0].data.Generator_reactive_power_L3,\n       B1_DG_DG_1_AC_Reactive_Power_var:data[0].data.Generator_reactive_power,\n       B1_DG_DG_1_Energy_Daily_kwh:data[0].data.Generator_Export_Day,\n       B1_DG_DG_1_Energy_Total_kwh:data[0].data.Generator_Export_Total,\n       B1_DG_DG_1_Engine_Speed_RPM:data[0].data.Engine_Speed,\n       B1_DG_DG_1_Fuel_Rate:data[0].data.Fuel_rate,\n       B1_DG_DG_1_Run_Time:data[0].data.Running_hrs\n\n    \n   }\n},\n{\n   deviceName: 'BP720-DG-2',\n   telemetry: {\n       //rawData: payloadStr,\n       B1_DG_DG_2_VOLT_L1_L2:data[0].data.Generator_voltage_L1_L2,\n       B1_DG_DG_2_VOLT_L2_L3:data[0].data.Generator_voltage_L2_L3,\n       B1_DG_DG_2_VOLT_L3_L1:data[0].data.Generator_voltage_L3_L1,\n       B1_DG_DG_2_Frequency_Hz_L1:data[0].data.Generator_frequency_L1/100,\n       B1_DG_DG_2_Frequency_Hz_L2:data[0].data.Generator_frequency_L2/100,\n       B1_DG_DG_2_Frequency_Hz_L3:data[0].data.Generator_frequency_L3/100,\n       B1_DG_DG_2_AMP_L1:data[0].data.Generator_current_L1/10,\n       B1_DG_DG_2_AMP_L2:data[0].data.Generator_current_L2/10,\n       B1_DG_DG_2_AMP_L3:data[0].data.Generator_current_L3/10,\n       B1_DG_DG_2_AC_Active_Power_Watt_L1:data[0].data.Generator_power_L1,\n       B1_DG_DG_2_AC_Active_Power_Watt_L2:data[0].data.Generator_power_L2,\n       B1_DG_DG_2_AC_Active_Power_Watt_L3:data[0].data.Generator_power_L3,\n       B1_DG_DG_2_AC_Active_Power_Watt:data[0].data.Generator_power,\n       B1_DG_DG_2_AC_Reactive_Power_var_L1:data[0].data.Generator_reactive_power_L1,\n       B1_DG_DG_2_AC_Reactive_Power_var_L2:data[0].data.Mains_reactive_power_L2,\n       B1_DG_DG_2_AC_Reactive_Power_var_L3:data[0].data.Generator_reactive_power_L3,\n       B1_DG_DG_2_AC_Reactive_Power_var:data[0].data.Generator_reactive_power,\n       B1_DG_DG_2_Energy_Daily_kwh:data[0].data.Generator_Export_Day,\n       B1_DG_DG_2_Energy_Total_kwh:data[0].data.Generator_Export_Total,\n       B1_DG_DG_2_Engine_Speed_RPM:data[0].data.Engine_Speed,\n       B1_DG_DG_2_Fuel_Rate:data[0].data.Fuel_rate,\n       B1_DG_DG_2_Run_Time:data[0].data.Running_hrs\n\n    \n   }\n},\n\n{\n   deviceName: 'BP720-DG-3',\n   telemetry: {\n       //rawData: payloadStr,\n       B1_DG_DG_3_VOLT_L1_L2:data[0].data.Generator_voltage_L1_L2,\n       B1_DG_DG_3_VOLT_L2_L3:data[0].data.Generator_voltage_L2_L3,\n       B1_DG_DG_3_VOLT_L3_L1:data[0].data.Generator_voltage_L3_L1,\n       B1_DG_DG_3_Frequency_Hz_L1:data[0].data.Generator_frequency_L1/100,\n       B1_DG_DG_3_Frequency_Hz_L2:data[0].data.Generator_frequency_L2/100,\n       B1_DG_DG_3_Frequency_Hz_L3:data[0].data.Generator_frequency_L3/100,\n       B1_DG_DG_3_AMP_L1:data[0].data.Generator_current_L1/10,\n       B1_DG_DG_3_AMP_L2:data[0].data.Generator_current_L2/10,\n       B1_DG_DG_3_AMP_L3:data[0].data.Generator_current_L3/10,\n       B1_DG_DG_3_AC_Active_Power_Watt_L1:data[0].data.Generator_power_L1,\n       B1_DG_DG_3_AC_Active_Power_Watt_L2:data[0].data.Generator_power_L2,\n       B1_DG_DG_3_AC_Active_Power_Watt_L3:data[0].data.Generator_power_L3,\n       B1_DG_DG_3_AC_Active_Power_Watt:data[0].data.Generator_power,\n       B1_DG_DG_3_AC_Reactive_Power_var_L1:data[0].data.Generator_reactive_power_L1,\n       B1_DG_DG_3_AC_Reactive_Power_var_L2:data[0].data.Mains_reactive_power_L2,\n       B1_DG_DG_3_AC_Reactive_Power_var_L3:data[0].data.Generator_reactive_power_L3,\n       B1_DG_DG_3_AC_Reactive_Power_var:data[0].data.Generator_reactive_power,\n       B1_DG_DG_3_Energy_Daily_kwh:data[0].data.Generator_Export_Day,\n       B1_DG_DG_3_Energy_Total_kwh:data[0].data.Generator_Export_Total,\n       B1_DG_DG_3_Engine_Speed_RPM:data[0].data.Engine_Speed,\n       B1_DG_DG_3_Fuel_Rate:data[0].data.Fuel_rate,\n       B1_DG_DG_3_Run_Time:data[0].data.Running_hrs\n\n    \n   }\n},\n//{\n  //  deviceName: 'AGC_Agg',\n  // telemetry: {\n  //     Generator_Daily_energy:(data[0].data.Generator_Export_Day + data[1].data.Generator_Export_Day + data[2]//.data.Generator_Export_Day),\n  //     Generator_Power:(data[0].data.Generator_power + data[1].data.Generator_power + data[2].data.Generator_power),\n  //     AGC1_running:(data[0].data.Generator_power>0),\n //      AGC2_running:(data[1].data.Generator_power>0),\n //      AGC3_running:(data[2].data.Generator_power>0),\n       \n //  }\n//},\n{\n     deviceName:'cal' ,\n    telemetry: {\n       Generator_Daily_energy_sum:(data[0].data.Generator_Export_Day + data[1].data.Generator_Export_Day + data[2].data.Generator_Export_Day),\n       AGC4_POWER_cal:data[3].data.Generator_power,\n       DG_Total_Power:(data[0].data.Generator_power + data[1].data.Generator_power + data[2].data.Generator_power),\n       DG_Total_Energy : (data[0].data.Generator_Export_Day+data[1].data.Generator_Export_Day+data[2].data.Generator_Export_Day),\n       Grid_AVG_Frequency : (data[3].data.Generator_frequency_L1/100+data[3].data.Generator_frequency_L2/100+data[3].data.Generator_frequency_L3/100)/3,\n       Total_Grid_Power:data[3].data.Generator_power,\n       Grid_Daily_Energy_Import_kWh:data[4].data.Import_day,\n       Grid_Daily_Energy_Export_kWh:data[3].data.Generator_Export_Day,\n       Grid_AVG_Voltage : (data[3].data.Generator_voltage_L1_L2+data[3].data.Generator_voltage_L2_L3+data[3].data.Generator_voltage_L3_L1)/3,\n       \n   }\n}];\n\n/** Helper functions 'decodeToString' and 'decodeToJson' are already built-in **/\n\nreturn result;",
      "encoder" : null,
      "tbelEncoder" : null,
      "updateOnlyKeys" : [ "manufacturer" ]
    },
    "debugMode" : true,
    "edgeTemplate" : false,
    "externalId" : null,
    "id" : {
      "entityType" : "CONVERTER",
      "id" : "f2bdb6f0-1d85-11ef-982c-0f5367becb87"
    },
    "name" : "Uplink data converter for AGC",
    "type" : "UPLINK"
  },
  "relations" : [ ],
  "attributes" : {
    "SERVER_SCOPE" : [ ]
  }
}