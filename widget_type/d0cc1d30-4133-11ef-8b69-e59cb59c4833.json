{
  "entityType" : "WIDGET_TYPE",
  "entity" : {
    "fqn" : "curtailment",
    "name" : "curtailment",
    "deprecated" : false,
    "image" : null,
    "description" : null,
    "descriptor" : {
      "type" : "timeseries",
      "sizeX" : 8,
      "sizeY" : 19,
      "resources" : [ {
        "url" : "https://cdn.jsdelivr.net/npm/gridjs/dist/gridjs.umd.js"
      }, {
        "url" : "https://cdn.jsdelivr.net/npm/gridjs/dist/theme/mermaid.min.css"
      }, {
        "url" : "https://unpkg.com/gridjs/dist/theme/mermaid.min.css"
      }, {
        "url" : "https://unpkg.com/jquery/dist/jquery.min.js"
      }, {
        "url" : "https://unpkg.com/gridjs-jquery/dist/gridjs.production.min.js"
      }, {
        "url" : "https://cdn.jsdelivr.net/npm/gridjs/dist/gridjs.production.min.js"
      }, {
        "url" : "https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"
      }, {
        "url" : "https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"
      } ],
      "templateHtml" : "<!--<button onclick=\"downloadPDF()\">Download PDF</button>-->\r\n<div id=\"reportCurtailment\" class=\"tb-widget\" data-widget-id=\"widget_inverter\" style=\"display: block;\">\r\n    <div id=\"report-header-Curtailment\">\r\n        <div id=\"report-logo\">\r\n            <img src=\"/api/images/public/3QfkrKt4SnzYSo7S50hZH2plJFmyKwxh\" alt=\"cogneta full-05.png\" style=\"height:100px;width:200px\">\r\n        </div>\r\n        <div id=\"report-dot\"><b>Curtailment Report</b></div>\r\n    </div>\r\n    <div id =\"report-info\">\r\n        <b>Client Name:-</b> <span> Aa-Bb-Cc</span><br>\r\n        <b>Manufactured By:-</b> <span> A-B-C</span><br>\r\n        <b>Print Interval:-</b> <span> x-y-z</span><br>\r\n        <b>Equipment Name:-</b> <span> p-q-r</span><br>\r\n    </div>\r\n    <div id=\"report-Curtailment\"></div>\r\n    <center>\r\n        <button onclick=\"downloadCSVCurtailment()\" id=\"dBtn\">Download CSV</button>    \r\n    </center>\r\n</div>",
      "templateCss" : "    /*#reportEnergy {*/\n    /*    display: none;*/\n    /*}*/\n    \n    .report2 {\n        margin: 0;\n        padding: 0;\n        overflow-y: auto;\n    }\n    #report-header-Curtailment {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        width: 100%;\n        border: 1px solid #999;\n    }\n    #report-dot {\n        color: #000;\n        padding-right: 10px;\n        letter-spacing: 1px;\n    }\n    #report-info {\n        display: none;\n        width: 100%;\n        font-size: 14px;\n        font-weight: 500;\n        border: 1px solid #999;\n        border-top: none;\n        padding: 10px;\n        letter-spacing: 1px;\n    }\n    #report-info b {\n        padding: 5px;\n    }\n    #report-info span{\n        color: #888;\n        font-style: italic;\n    }\n    .table {\n        border: 1px solid #999;\n        border-collapse: collapse;\n    }\n    /*.tr {*/\n    /*    border: 1px solid #999;*/\n    /*}*/\n    .tr:nth-child(even) {\n        background: #e9e9e9; /* light gray */\n    }\n    .th {\n        background-color: white;\n        color: #000;\n        border-bottom: 1px solid #ccc;\n        border-bottom: 2px solid black;\n        text-align: center;\n        border: none;\n        padding: 0;\n    }\n    .td {\n        border: none;\n        text-align: center;\n        background: transparent;\n        padding: 0;\n    }\n    #report-Curtailment {\n        margin: -3px 0 0 0;\n        padding: 0;\n    }\n\n        \n    #dBtn {\n      font-family: \"Open Sans\", sans-serif;\n      font-size: 16px;\n      letter-spacing: 2px;\n      text-decoration: none;\n      text-transform: uppercase;\n      color: #000;\n      cursor: pointer;\n      border: 3px solid;\n      padding: 0.25em 0.5em;\n      box-shadow: 1px 1px 0px 0px, 2px 2px 0px 0px, 3px 3px 0px 0px, 4px 4px 0px 0px, 5px 5px 0px 0px;\n      position: relative;\n      user-select: none;\n      -webkit-user-select: none;\n      touch-action: manipulation;\n    }\n    \n    #dBtn:active {\n      box-shadow: 0px 0px 0px 0px;\n      top: 5px;\n      left: 5px;\n    }\n    \n    @media (min-width: 768px) {\n      #dBtn {\n        padding: 0.25em 0.75em;\n      }\n    }",
      "controllerScript" : "\r\nself.onInit = function() {\r\n    var columnCurtailment = [\"TS\"];\r\n    var dataCurtailment = [];\r\n    for(var i=0; i < self.ctx.data.length ; i++){\r\n        dataCurtailment.push(self.ctx.data[i].data);\r\n        columnCurtailment.push(self.ctx.data[i].label);\r\n    }\r\n    \r\n    var gridCurtailment = $(\"div#report-Curtailment\").Grid({\r\n            pagination:false,\r\n            fixedHeader: true,\r\n            height: 'auto',\r\n            resizable: true,\r\n            columns : columnCurtailment,\r\n            data : [],\r\n            className : {\r\n                table : \"table\",\r\n                tr : \"tr\",\r\n                th : \"th\",\r\n                td : \"td\"\r\n            },\r\n            \r\n        });\r\n        \r\n    \r\n};\r\n\r\nself.onDataUpdated = function() {\r\n    var columnCurtailment = [\"Date & Time\"];\r\n    var dataCurtailment = [];\r\n    for(var i=0; i < self.ctx.data.length ; i++){\r\n        columnCurtailment = [\r\n            \"Date & Time\",\r\n          'Solar Generation Curtailed due to DG Running at minimum 30% load',\r\n          { \r\n            name: 'Solar loss due to DG',\r\n            data: null,\r\n            formatter: (_, row) => `${(Number(row.cells[1].data)*3).toLocaleString()}`\r\n          },\r\n          { \r\n            name: 'Total Loss',\r\n            data: null,\r\n            formatter: (_, row) => `${(Number(row.cells[1].data)*3).toLocaleString()}`\r\n          },\r\n          \r\n      ]\r\n        if (i==0) {\r\n            dataCurtailment.push(\r\n              self.ctx.data[i].data.map(elem => {\r\n                let date = new Date(elem[0]);\r\n                date.setHours(0, -1, 0, 0);\r\n                return date.toLocaleString();\r\n                })\r\n            );\r\n            dataCurtailment.push(self.ctx.data[i].data.map(elem => (elem[1]).toFixed(2)));\r\n        }\r\n        else{\r\n            dataCurtailment.push(self.ctx.data[i].data.map(elem => Number(elem[1]).toFixed(2)));\r\n        }\r\n    }\r\n\r\n        var gridDataCurtailment = [];\r\n    if (dataCurtailment[0].length > 0) {\r\n        \r\n        for (var k = (dataCurtailment[0].length - 1); k >= 0; k--) {\r\n            var tempArrayCurtailment = [];\r\n            for (var j = 0; j < dataCurtailment.length; j++) {\r\n                tempArrayCurtailment.push(dataCurtailment[j][k]);\r\n            }\r\n            gridDataCurtailment.push(tempArrayCurtailment);\r\n        }\r\n    }\r\n    \r\n    // Prepare the updated data for the grid\r\n    $(\"div#report-Curtailment\").empty();\r\n    var gridCurtailment = $(\"div#report-Curtailment\").Grid({\r\n            // pagination: {\r\n            //     limit : 10,\r\n            //     summary: false,\r\n            //     resetPageOnUpdate: false\r\n            // },\r\n            pagination : false,\r\n            fixedHeader: true,\r\n            resizable: true,\r\n            // height: \"600px\",\r\n        columns : columnCurtailment,\r\n        data :gridDataCurtailment,\r\n        className : {\r\n            container: \"report2\",\r\n            table : \"table\",\r\n            tr : \"tr\",\r\n            th : \"th\",\r\n            td : \"td\"\r\n        },\r\n    });\r\n    gridCurtailment.forceRender();\r\n\r\ndownloadPDF = function() {\r\n    var element = document.getElementById('report-Curtailment'); \r\n    html2pdf(element);\r\n}\r\n\r\ndownloadCSVCurtailment = function() {\r\n    var csvDataCurtailment = []\r\n    // Add column names as the first row\r\n    csvDataCurtailment.push(columnCurtailment);\r\n\r\n    // Add grid data rows\r\n    csvDataCurtailment = csvDataCurtailment.concat(gridDataCurtailment);\r\n    \r\n    var csvCurtailment = Papa.unparse(csvDataCurtailment);\r\n\r\n        // Create a Blob\r\n        var blobCurtailment = new Blob([csvCurtailment], { type: 'text/csv;charset=utf-8;' });\r\n\r\n        // Trigger the download\r\n        var downloadLinkCurtailment = document.createElement('a');\r\n        downloadLinkCurtailment.href = window.URL.createObjectURL(blobCurtailment);\r\n        downloadLinkCurtailment.setAttribute('download', `Solar-Saving_${new Date().getDate()}-${new Date().getMonth()+1}-${new Date().getFullYear()}.csv`);\r\n        downloadLinkCurtailment.click();\r\n};\r\n    console.timeEnd(\"END\");\r\n};\r\n\r\n\r\n",
      "settingsSchema" : "{}",
      "dataKeySettingsSchema" : "{}",
      "latestDataKeySettingsSchema" : "{}",
      "settingsDirective" : "tb-flot-line-widget-settings",
      "dataKeySettingsDirective" : "tb-flot-line-key-settings",
      "latestDataKeySettingsDirective" : "tb-flot-latest-key-settings",
      "hasBasicMode" : true,
      "basicModeDirective" : "tb-flot-basic-config",
      "defaultConfig" : "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"First\",\"color\":\"#2196f3\",\"settings\":{\"showLines\":true,\"fillLines\":true,\"showPoints\":false},\"_hash\":0.8587686344902596,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Second\",\"color\":\"#ffc107\",\"settings\":{\"showLines\":true,\"fillLines\":false,\"showPoints\":false},\"_hash\":0.12775350966079668,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Third\",\"color\":\"#f44336\",\"settings\":{},\"_hash\":0.7790117025744843,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\",\"decimals\":0,\"aggregationType\":null,\"usePostProcessing\":null,\"postFuncBody\":null}]}],\"timewindow\":{\"hideInterval\":false,\"hideLastInterval\":false,\"hideQuickInterval\":false,\"hideAggregation\":false,\"hideAggInterval\":false,\"hideTimezone\":false,\"selectedTab\":0,\"realtime\":{\"realtimeType\":0,\"timewindowMs\":2592000000,\"quickInterval\":\"CURRENT_DAY\",\"interval\":7200000},\"aggregation\":{\"type\":\"AVG\",\"limit\":25000},\"timezone\":null},\"showTitle\":false,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"0px\",\"settings\":{\"stack\":false,\"fontSize\":10,\"fontColor\":\"#545454\",\"showTooltip\":true,\"tooltipIndividual\":false,\"tooltipCumulative\":false,\"hideZeros\":false,\"grid\":{\"verticalLines\":true,\"horizontalLines\":true,\"outlineWidth\":1,\"color\":\"#545454\",\"backgroundColor\":null,\"tickColor\":\"#DDDDDD\"},\"xaxis\":{\"title\":null,\"showLabels\":true,\"color\":\"#545454\"},\"yaxis\":{\"min\":null,\"max\":null,\"title\":null,\"showLabels\":true,\"color\":\"#545454\",\"tickSize\":null,\"tickDecimals\":0,\"ticksFormatter\":\"\"},\"shadowSize\":4,\"smoothLines\":false,\"comparisonEnabled\":false,\"xaxisSecond\":{\"axisPosition\":\"top\",\"title\":null,\"showLabels\":true},\"showLegend\":true,\"legendConfig\":{\"direction\":\"column\",\"position\":\"bottom\",\"sortDataKeys\":false,\"showMin\":false,\"showMax\":false,\"showAvg\":true,\"showTotal\":false,\"showLatest\":false},\"customLegendEnabled\":false},\"title\":\"curtailment\",\"dropShadow\":true,\"enableFullscreen\":true,\"titleStyle\":{\"fontSize\":\"16px\",\"fontWeight\":400},\"mobileHeight\":null,\"configMode\":\"advanced\",\"actions\":{},\"showTitleIcon\":false,\"titleIcon\":\"thermostat\",\"iconColor\":\"#1F6BDD\",\"useDashboardTimewindow\":false,\"displayTimewindow\":true,\"titleFont\":null,\"titleColor\":null,\"enableDataExport\":true,\"widgetStyle\":{},\"widgetCss\":\"\",\"pageSize\":1024,\"noDataDisplayMessage\":\"\"}"
    },
    "externalId" : null,
    "id" : {
      "entityType" : "WIDGET_TYPE",
      "id" : "d0cc1d30-4133-11ef-8b69-e59cb59c4833"
    },
    "tags" : null
  },
  "relations" : [ ],
  "attributes" : {
    "SERVER_SCOPE" : [ ]
  }
}